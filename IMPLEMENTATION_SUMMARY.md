# 면접 일정 자동화 시스템 v3.0 구현 완료 요약

## ✅ 완료된 작업

### 1. Google Apps Script 업데이트 (9개 시트 구조)
- ✅ `interviews` - 면접 기본 정보
- ✅ `candidates` - 면접자 정보 (신규)
- ✅ `interview_candidates` - 면접-면접자 매핑 (신규)
- ✅ `candidate_interviewers` - 면접자별 담당 면접관 (신규, N:N)
- ✅ `interviewers` - 면접관 DB (is_team_lead 추가)
- ✅ `interview_interviewers` - 면접-면접관 매핑 (reminder_sent_count 추가)
- ✅ `time_selections` - 일정 선택 (30분 단위)
- ✅ `confirmed_schedules` - 확정 일정 (candidate_id 추가)
- ✅ `config` - 시스템 설정 (신규)

### 2. Backend 서비스 구현

#### 2.1 Google Sheets Service
- ✅ N:N 매핑 구조 지원
- ✅ Config 조회/업데이트 기능
- ✅ 면접자별 담당 면접관 조회

#### 2.2 Time Slots Utility
- ✅ 30분 단위 타임 슬롯 생성
- ✅ 점심시간 자동 제외
- ✅ 면접 종료 시간 자동 계산
- ✅ 면접자별 시간 슬롯 계산
- ✅ 최소 사전 통보 시간 확인

#### 2.3 Email Template Service
- ✅ 면접관 초대 메일 템플릿
- ✅ D-1 리마인더 템플릿
- ✅ 미응답 리마인더 템플릿
- ✅ 확정 알림 템플릿
- ✅ 설정 기반 동적 템플릿 (로고, 주소, 주차, 복장)

#### 2.4 Scheduler Service
- ✅ 미응답 리마인더 (48시간, 72시간)
- ✅ D-1 리마인더 (면접 전날 오후 5시)
- ✅ 자동 확정 처리 (매일 오전 9시)
- ✅ 설정 기반 동적 스케줄링

### 3. API 라우트 업데이트

#### 3.1 면접 생성 API (N:N 구조)
- ✅ 면접자별 담당 면접관 배정
- ✅ 30분 단위 시간 슬롯 자동 계산
- ✅ 팀장급 필수 검증
- ✅ 최소 사전 통보 시간 검증
- ✅ 면접관별 맞춤 메일 발송 (담당 면접자 정보 포함)

#### 3.2 Config API (신규)
- ✅ 설정 조회: `GET /api/config`
- ✅ 설정 업데이트: `PUT /api/config`

### 4. 주요 기능

#### 4.1 N:N 매핑
- 면접자별로 다른 면접관 배정 가능
- 예: 면접자 A는 김영준+정주연, 면접자 B는 김종휘+김희수
- PRIMARY/SECONDARY 역할 구분

#### 4.2 30분 단위 타임 슬롯
- 09:00, 09:30, 10:00, 10:30... 18:00까지
- 점심시간(12:00~13:00) 자동 제외
- 설정에서 시간대 변경 가능

#### 4.3 메일 발송 규칙 관리
- 리마인더 발송 시간 설정 가능
- 메일 템플릿 관리
- 발송 시간대 제한
- 회사 정보 동적 삽입

## 📋 다음 단계 (Frontend)

### 1. 면접 등록 화면 업데이트
- [ ] 면접자별 담당 면접관 선택 UI
- [ ] 30분 단위 타임 슬롯 선택 UI
- [ ] 종료 시간 자동 계산 표시
- [ ] 팀장급 필수 검증

### 2. 면접 상세 화면
- [ ] N:N 매핑 구조 표시
- [ ] 면접자별 시간 슬롯 표시
- [ ] 면접자별 담당 면접관 표시

### 3. 설정 관리 화면
- [ ] 설정 조회/수정 UI
- [ ] 타임 슬롯 설정
- [ ] 리마인더 설정
- [ ] 회사 정보 설정

## 🔧 환경 변수

기존 환경 변수에 추가할 항목 없음 (기존 `.env` 파일 그대로 사용)

## 📝 Google Apps Script 배포

1. Google Sheets에서 Apps Script 편집기 열기
2. `google-apps-script/Code.gs` 내용 복사/붙여넣기
3. API 키 확인: `const API_KEY = 'aj-innovation-2025-secret-key-xyz123';`
4. 배포 → 새 배포 → 웹 앱으로 실행
5. 배포 URL을 `GOOGLE_APPS_SCRIPT_URL`에 설정

## 🎯 주요 변경 사항

### 기존 vs 신규

| 항목 | 기존 | 신규 |
|------|------|------|
| 면접자 관리 | 단일 필드 | 별도 테이블 (candidates) |
| 면접관 배정 | 면접 전체 | 면접자별 (N:N) |
| 타임 슬롯 | 자유 입력 | 30분 단위 고정 |
| 설정 관리 | 하드코딩 | Config 시트 |
| 메일 템플릿 | 단순 HTML | 동적 템플릿 서비스 |
| 리마인더 | 1회 | 설정 가능 (최대 2회) |

## ✅ 테스트 체크리스트

- [ ] 면접 생성 (N:N 구조)
- [ ] 면접자별 담당 면접관 배정
- [ ] 30분 단위 타임 슬롯 생성
- [ ] 메일 발송 (면접관별 맞춤)
- [ ] 리마인더 발송 (48시간, 72시간)
- [ ] D-1 리마인더 발송
- [ ] 자동 확정 처리
- [ ] 설정 조회/수정
- [ ] 팀장급 필수 검증
- [ ] 최소 사전 통보 시간 검증

## 📚 참고 문서

- [기술 명세서](./docs/SPECIFICATION.md) - 원본 명세서
- [Google Apps Script 코드](./google-apps-script/Code.gs) - Apps Script 구현
- [API 문서](./docs/API.md) - API 엔드포인트 문서
